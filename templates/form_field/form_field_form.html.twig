{% extends '@OHMediaBackend/form.html.twig' %}

{% set form_field_fqns = 'OHMedia\\FormBundle\\Entity\\FormField' %}

{% block javascripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
  const typeChoice = "{{ constant(form_field_fqns ~ '::TYPE_CHOICE') }}";
  const typePhone = "{{ constant(form_field_fqns ~ '::TYPE_PHONE') }}";

  const type = document.getElementById('{{ form.type.vars.id }}');

  const form = type.form;

  const help = document.getElementById('{{ form.help.vars.id }}');

  const choices = document.getElementById('{{ form.choices.vars.id }}');

  const multiple = form.elements['{{ form.multiple.vars.full_name }}'];

  console.dir(multiple[0]);

  const multipleContainer = document.getElementById('{{ form.multiple.vars.id }}');

  function onTypeChange() {console.log(typeChoice, type.value);
    const isTypeChoice = typeChoice === type.value;
    const isTypePhone = typePhone === type.value;

    help.parentNode.style.display = isTypePhone ? 'none' : '';

    choices.parentNode.style.display = isTypeChoice ? '' : 'none';
    choices.required = isTypeChoice;

    multipleContainer.parentNode.style.display = isTypeChoice ? '' : 'none';
    multiple.forEach((radio) => {
      radio.required = isTypeChoice;
    });
  }

  type.addEventListener('change', onTypeChange);

  onTypeChange();
});
</script>
{% endblock %}
